<!DOCTYPE html>
<html>
<head>
    <title>Landsat 5 RGB</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <!-- Librairies nÃ©cessaires -->
    <script src="https://unpkg.com/geotiff/dist/geotiff.browser.min.js"></script>
    <script src="https://unpkg.com/georaster/dist/georaster.browser.min.js"></script>
    <script src="https://unpkg.com/georaster-layer-for-leaflet/dist/georaster-layer-for-leaflet.min.js"></script>

    <style>
        body, html { margin: 0; padding: 0; height: 100%; }
        #map { width: 100%; height: 100vh; }
    </style>
</head>

<body>
    <div id="map"></div>

    <script>
        const map = L.map('map').setView([0, 0], 2);

        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19
        }).addTo(map);

        fetch("landsat5.tif")
            .then(res => res.arrayBuffer())
            .then(buffer => parseGeoraster(buffer))
            .then(georaster => {

                console.log("Band count :", georaster.numberOfRasters);
                console.log("Projection :", georaster.projection);

                // RGB Landsat 5 = bandes 3, 2, 1
                const layer = new GeoRasterLayer({
                    georaster: georaster,
                    pixelValuesToColorFn: values => {
                        const red   = values[2]; // bande 3
                        const green = values[1]; // bande 2
                        const blue  = values[0]; // bande 1
                        return `rgb(${red}, ${green}, ${blue})`;
                    },
                    resolution: 256
                });

                layer.addTo(map);
                map.fitBounds(layer.getBounds());
            });
    </script>
</body>
</html>
